

<!DOCTYPE html>

<html lang="it">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Security Wallet</title>

    

    <!-- Icone per iOS e Android (usano il nuovo logo della DApp) -->

    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/cjconsultingspecialist-cell/USDT/refs/heads/main/wallet_icon.jpg">

    <link rel="icon" href="https://raw.githubusercontent.com/cjconsultingspecialist-cell/USDT/refs/heads/main/wallet_icon.jpg">

    <meta name="theme-color" content="#27ae60">


    <!-- Libreria Ethers.js per la connessione Blockchain -->

    <script src="cdnjs.cloudflare.com"></script>

    

    <style>

        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; text-align: center; padding: 40px 20px; background: #f0f2f5; color: #1c1e21; }

        .card { background: white; padding: 40px; border-radius: 24px; display: inline-block; box-shadow: 0 12px 40px rgba(0,0,0,0.12); border: 1px solid #e1e4e8; max-width: 380px; width: 100%; }

        .app-title { font-size: 28px; font-weight: 800; color: #1a73e8; margin-bottom: 5px; }

        .app-subtitle { font-size: 14px; color: #5f6368; margin-bottom: 25px; text-transform: uppercase; letter-spacing: 1px; }

        img#tokenLogo { width: 110px; height: 110px; border-radius: 50%; margin-bottom: 15px; border: 4px solid #27ae60; padding: 4px; background: #fff; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }

        .price-tag { font-size: 18px; color: #27ae60; font-weight: 700; margin-bottom: 25px; }

        .balance-container { background: #f8f9fa; padding: 20px; border-radius: 16px; margin-bottom: 30px; border: 1px solid #dee2e6; }

        .balance-label { font-size: 13px; color: #70757a; margin-bottom: 8px; }

        #balance { font-size: 32px; font-weight: 700; margin: 0; color: #202124; }

        button { width: 100%; padding: 16px; font-size: 18px; cursor: pointer; background: #1a73e8; color: white; border: none; border-radius: 12px; transition: all 0.2s ease; font-weight: 600; }

        button:hover { background: #1557b0; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(26,115,232,0.3); }

        button:active { transform: translateY(0); }

        .status-box { margin-top: 20px; padding: 10px; border-radius: 8px; font-size: 13px; color: #5f6368; background: #fff; }

        #walletAddress { font-family: monospace; color: #1a73e8; font-weight: 600; }

    </style>

</head>

<body>


    <div class="card">

        <div class="app-title">Security Wallet</div>

        <div class="app-subtitle">Asset Management</div>

        

        <!-- Dati dinamici dal JSON -->

        <img id="tokenLogo" src="cjconsultingspecialist-cell.github.io" alt="Logo">

        <h2 id="tokenName" style="margin: 10px 0;">Tether USD</h2>

        <div class="price-tag">Value: <span id="tokenPrice">1.00 USD</span></div>

        

        <div class="balance-container">

            <div class="balance-label">DISPONIBILITÀ ATTUALE</div>

            <h2 id="balance">0.00 USDT</h2>

        </div>


        <button onclick="connectWallet()">Accedi con MetaMask</button>

        

        <div class="status-box">

            Stato: <span id="walletAddress">Wallet Disconnesso</span>

        </div>

    </div>


    <script>

        // Configurazione URL Database JSON

        const jsonUrl = "raw.githubusercontent.com";

        let contractAddress;


        // Funzione per caricare i dati estetici e tecnici dal database JSON

        async function loadAppData() {

            try {

                const response = await fetch(jsonUrl);

                if (!response.ok) throw new Error("Errore nel caricamento del database");

                const data = await response.json();

                

                document.getElementById('tokenName').innerText = data.name;

                // document.getElementById('tokenLogo').src = data.logoURI; // Non usiamo più il logo del token qui

                

                if(data.extensions && data.extensions.price_usd) {

                    document.getElementById('tokenPrice').innerText = data.extensions.price_usd + " USD";

                }

                

                contractAddress = data.address;

                console.log("DApp Pronta. Contratto collegato:", contractAddress);

            } catch (error) {

                console.error("Errore Inizializzazione:", error);

                document.getElementById('walletAddress').innerText = "Errore Database JSON";

            }

        }


        // Funzione per connettersi alla Blockchain Sepolia tramite MetaMask

        async function connectWallet() {

            if (window.ethereum) {

                try {

                    const provider = new ethers.BrowserProvider(window.ethereum);

                    const accounts = await provider.send("eth_requestAccounts", []);

                    const signer = await provider.getSigner();

                    const userAddress = await signer.getAddress();

                    

                    document.getElementById('walletAddress').innerText = userAddress.substring(0,6) + "..." + userAddress.substring(38);


                    const abi = ["function balanceOf(address) view returns (uint256)"];

                    const contract = new ethers.Contract(contractAddress, abi, provider);

                    

                    const balance = await contract.balanceOf(userAddress);

                    

                    const formattedBalance = Number(balance) / 1000000;

                    document.getElementById('balance').innerText = formattedBalance.toLocaleString('en-US', {minimumFractionDigits: 2}) + " USDT";

                    

                    console.log("Connessione riuscita per l'utente:", userAddress);

                } catch (err) {

                    console.error(err);

                    alert("Connessione fallita. Assicurati di essere sulla rete Sepolia.");

                }

            } else {

                alert("MetaMask non rilevato. Per favore installa l'estensione o usa il browser di MetaMask su Mobile.");

            }

        }


        loadAppData();

    </script>

</body>

</html>
